{% load cms_tags static sekizai_tags %}

<section
  id="hero"
  class="hero section hero--expanded light-background"
  {% if instance.background_image %}
    style="background-image: url('{{ instance.background_image.url }}');"
  {% endif %}
>
  <div class="container">
    <div class="row gy-4">
      <div
        class="col-lg-6 order-2 order-lg-1 d-flex flex-column justify-content-center"
        {% if instance.aos_animation %}
          data-aos="{{ instance.aos_animation }}"
        {% endif %}
      >
        <h1>
          <span class="hero__title-line hero__title-line--primary">{{ instance.title_part1 }}</span>
          <span class="hero__title-line hero__title-line--accent">{{ instance.title_part2 }}</span>
        </h1>

        {% if instance.description %}
          <p>{{ instance.description|safe }}</p>
        {% endif %}

        <div class="d-flex">
          {% if instance.get_started_text and instance.get_started_url %}
            <a
              href="{{ instance.get_started_url }}"
              class="btn-get-started"
              data-hero-scroll
            >
              {{ instance.get_started_text }}
            </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</section>

{% addtoblock "css" %}
<style>
  .hero.hero--expanded {
    min-height: calc(100vh - 120px);
    padding: clamp(3rem, 6vw, 5rem) 0;
    display: flex;
    align-items: center;
    background-position: center center;
    background-repeat: no-repeat;
    background-size: cover;
  }
  .hero.hero--expanded::before {
    content: "";
    position: absolute;
    inset: clamp(1.5rem, 3vw, 2.5rem);
    border-radius: 32px;
    background: rgba(255, 255, 255, 0.84);
    z-index: 0;
  }
  .hero.hero--expanded .container {
    position: relative;
    z-index: 1;
  }
  .hero.hero--expanded h1 {
    font-size: clamp(2.2rem, 4.4vw, 3.4rem);
    line-height: 1.1;
    font-weight: 750;
    display: flex;
    flex-direction: column;
    gap: 0.45rem;
  }
  .hero__title-line {
    display: block;
    white-space: nowrap;
  }
  .hero.hero--expanded .hero__title-line--primary {
    color: var(--heading-color);
  }
  .hero__title-line--accent {
    color: var(--accent-color);
  }
  .hero.hero--expanded p {
    font-size: clamp(1.05rem, 1.6vw, 1.35rem);
    line-height: 1.5;
    color: rgba(15, 23, 42, 0.75);
    margin-bottom: clamp(1.5rem, 3vw, 2.2rem);
  }
  .hero.hero--expanded .btn-get-started {
    font-size: 1rem;
    padding: 0.85rem 2.4rem;
    border-radius: 999px;
  }
  @media (max-width: 767.98px) {
    .hero.hero--expanded {
      min-height: auto;
      padding: clamp(2.2rem, 10vw, 3rem) 0;
    }
    .hero.hero--expanded::before {
      inset: clamp(0.75rem, 4vw, 1.2rem);
      border-radius: 20px;
    }
  }
</style>
{% endaddtoblock %}

{% addtoblock "js" %}
<script>
  (function () {
    function getHeaderOffset() {
      var header = document.querySelector('#header');
      if (!header) return 64;
      var rect = header.getBoundingClientRect();
      var height = rect.height || header.offsetHeight || 0;
      return Math.max(height - 28, 56);
    }

    function computeAnchorTop(anchor) {
      if (!anchor) return 0;
      var rect = anchor.getBoundingClientRect();
      return Math.max(rect.top + window.scrollY - getHeaderOffset(), 0);
    }

    function performScroll(top) {
      if (typeof window.scrollToWithOffset === 'function') {
        window.scrollToWithOffset(top);
        return;
      }
      var docEl = document.documentElement;
      var body = document.body;
      var prevHtmlBehavior = docEl.style.scrollBehavior;
      var prevBodyBehavior = body.style.scrollBehavior;
      docEl.style.scrollBehavior = 'auto';
      body.style.scrollBehavior = 'auto';
      window.scrollTo({ top: top, behavior: 'smooth' });
      window.requestAnimationFrame(function () {
        docEl.style.scrollBehavior = prevHtmlBehavior;
        body.style.scrollBehavior = prevBodyBehavior;
      });
    }

    function scrollToAnchor(target) {
      var anchor = typeof target === 'string' ? document.querySelector(target) : target;
      if (!anchor) return;
      var firstTop = computeAnchorTop(anchor);
      performScroll(firstTop);
      window.setTimeout(function () {
        var settleTop = computeAnchorTop(anchor);
        if (Math.abs(window.scrollY - settleTop) > 4) {
          performScroll(settleTop);
        }
      }, 450);
    }

    document.addEventListener("click", function (event) {
      var trigger = event.target.closest('a[data-hero-scroll][href^="#"]');
      if (!trigger) return;
      var hash = trigger.getAttribute("href");
      var target = document.querySelector(hash);
      if (!target) return;
      event.preventDefault();
      if (typeof window.__disableHeaderSnap === "function") {
        window.__disableHeaderSnap(800);
      }
      history.replaceState(null, "", hash);
      scrollToAnchor(target);
    }, { passive: false });
  })();
</script>
{% endaddtoblock %}
